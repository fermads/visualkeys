!function(e){function i(e){var i=e.keyCode;return(e.shiftKey||e.ctrlKey)&&32==i||120==i&&!f?(t(),!1):f||(e.metaKey||e.altKey)&&e.ctrlKey?(o(i),!1):void(27==i&&s[27]&&s[i].exec(i,s[i]))}function t(){if(d){for(var i in s)e("#visualkeys.key"+i).removeClass("hide"),s[i].hide&&s[i].hide()&&e("#visualkeys.key"+i).addClass("hide");f=!0,d.show()}else n()}function n(){var i,n,o,r="";e("body").remove("#visualkeys").append('<div id="visualkeys"><em></em><ul></ul></div>');for(i in s){if(n=s[i],"number"!=typeof parseInt(i,10))throw Error("key should ba a number representing a keyCode");if(!n.text||"string"!=typeof n.text)throw Error("text is required and should be a string");if(!n.exec||"function"!=typeof n.exec)throw Error("exec is required and should be a function");if(n.hide&&"function"!=typeof n.hide)throw Error("hide should be a function and return true|false");o=n.hide&&n.hide()?"hide":"",r+='<li onclick="$.visualkeys('+i+')" class="key'+i+" "+o+'">'+n.text+"</li>"}a=e("#visualkeys em"),d=e("#visualkeys ul"),d.hide(),d.html(r),t()}function o(i){d||n(),f=!1,d.hide();var t=s[i];if(t){setTimeout(function(){t.exec(i,t)},100);var o=e(".key"+i+" b").text()||"";a.html(o).show().fadeOut("slow",function(){a.empty()})}}function r(){e("#visualkeys").remove(),e(document).unbind("keydown",i),e("iframe").contents().unbind("keydown",i)}function u(t){d=!1,s=t,e(document).keydown(i),setTimeout(function(){e("iframe").contents().keydown(i)},3e3)}var s,d,a,f=!1;e.visualkeys=function(e){"object"==typeof e?u(e):"number"==typeof e?o(e):"remove"==e&&r()}}(jQuery);